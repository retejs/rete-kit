name: Regression build

on:
  workflow_dispatch:
  schedule:
    - cron: '0 2 * * *'

jobs:
  ubuntu-angular:
    name: "Ubuntu: Angular"
    uses: ./.github/workflows/test-build-angular.yml
    with:
      os: ubuntu-latest
  
  windows-angular:
    name: "Windows: Angular"
    needs: ubuntu-angular
    uses: ./.github/workflows/test-build-angular.yml
    with:
      os: windows-latest
  
  macos-angular:
    name: "MacOS: Angular"
    needs: windows-angular
    uses: ./.github/workflows/test-build-angular.yml
    with:
      os: macos-latest

  react:
    name: React
    strategy:
      fail-fast: false
      max-parallel: 3
      matrix:
        version: [18,17,16]
        os: [ubuntu-latest, windows-latest, macos-latest]
    uses: ./.github/workflows/test-build.yml
    with:
      os: ${{ matrix.os }}
      stack: react
      version: ${{ matrix.version }}
      node: 18
      features: "React render,${{ vars.FEATURES }}"

  vue:
    name: Vue
    strategy:
      fail-fast: false
      max-parallel: 3
      matrix:
        version: [3,2]
        os: [ubuntu-latest, windows-latest, macos-latest]
    uses: ./.github/workflows/test-build.yml
    with:
      os: ${{ matrix.os }}
      stack: vue
      version: ${{ matrix.version }}
      node: 18
      features: "Vue render,${{ vars.FEATURES }}"
        
  svelte:
    name: Svelte
    strategy:
      fail-fast: false
      max-parallel: 3
      matrix:
        version: [4,3]
        os: [ubuntu-latest, windows-latest, macos-latest]
    uses: ./.github/workflows/test-build.yml
    with:
      os: ${{ matrix.os }}
      stack: svelte
      version: ${{ matrix.version }}
      node: 18
      features: "Svelte render,${{ vars.FEATURES }}"
          
  vite:
    name: Vite
    strategy:
      fail-fast: false
      max-parallel: 3
      matrix:
        os: [ubuntu-latest, windows-latest, macos-latest]
    uses: ./.github/workflows/test-build.yml
    with:
      os: ${{ matrix.os }}
      stack: vite
      version: 18
      node: 18
      features: "React render,${{ vars.FEATURES }}"
          
  react-vite:
    name: React vite
    strategy:
      fail-fast: false
      max-parallel: 3
      matrix:
        version: [18,17,16]
        os: [ubuntu-latest, windows-latest, macos-latest]
    uses: ./.github/workflows/test-build.yml
    with:
      os: ${{ matrix.os }}
      stack: react-vite
      version: ${{ matrix.version }}
      node: 18
      features: "React render,${{ vars.FEATURES }}"

  vue-vite:
    name: Vue vite
    strategy:
      fail-fast: false
      max-parallel: 3
      matrix:
        version: [3,2]
        os: [ubuntu-latest, windows-latest, macos-latest]
    uses: ./.github/workflows/test-build.yml
    with:
      os: ${{ matrix.os }}
      stack: vue-vite
      version: ${{ matrix.version }}
      node: 18
      features: "Vue render,${{ vars.FEATURES }}"

  next:
    name: Next
    strategy:
      fail-fast: false
      max-parallel: 3
      matrix:
        os: [ubuntu-latest, windows-latest, macos-latest]
    uses: ./.github/workflows/test-build.yml
    with:
      os: ${{ matrix.os }}
      stack: next
      version: 18
      node: 18
      features: "React render,${{ vars.FEATURES }}"
      
  nuxt:
    name: Nuxt
    strategy:
      fail-fast: false
      max-parallel: 3
      matrix:
        os: [ubuntu-latest, windows-latest, macos-latest]
    uses: ./.github/workflows/test-build.yml
    with:
      os: ${{ matrix.os }}
      stack: nuxt
      version: 3
      node: 18
      features: "Vue render,${{ vars.FEATURES }}"
          
